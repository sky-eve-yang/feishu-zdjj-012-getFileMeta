# 附件元信息展示 - 飞书多维表格字段捷径

这是一个飞书多维表格的字段捷径插件，用于提取并展示附件的详细元信息，包括附件名、多单位大小、文件类型、扩展名和临时下载链接。

## 功能特点

- 📋 **完整元信息**：提取附件的名称、大小、类型、扩展名等详细信息
- 📏 **多单位大小**：同时显示 B、KB、MB、GB 四种单位的文件大小
- 📦 **批量处理**：支持单个或多个附件，智能汇总处理
- 🔗 **临时链接**：提供附件的临时下载链接
- 🌐 **多语言支持**：支持中文、英文、日文界面
- ⚡ **即时处理**：无需外部API调用，快速提取附件信息

## 展示信息

插件会展示以下附件信息：

| 字段名称       | 说明                                     | 单个附件示例      | 多个附件示例                    |
| -------------- | ---------------------------------------- | ----------------- | ------------------------------- |
| 附件名         | 附件名称（多个时用换行符分割）           | `document.pdf`    | `file1.pdf`<br>`image.jpg`     |
| 附件大小       | 格式化的总文件大小                       | `1.5 MB`          | `3.2 MB`                        |
| 附件大小/B     | 总字节数                                 | `1572864`         | `3355443`                       |
| 附件大小/KB    | 总KB大小                                 | `1536.00`         | `3276.80`                       |
| 附件大小/MB    | 总MB大小                                 | `1.50`            | `3.20`                          |
| 附件大小/GB    | 总GB大小                                 | `0.001`           | `0.003`                         |
| 附件类型       | MIME类型（多个时用换行符分割）           | `application/pdf` | `application/pdf`<br>`image/jpeg` |
| 附件扩展名     | 文件扩展名（多个时用换行符分割）         | `pdf`             | `pdf`<br>`jpg`                  |
| 附件链接(临时) | 临时下载链接（多个时用换行符分割）       | `https://...`     | `https://file1...`<br>`https://file2...` |

### 多附件处理规则

- **名称、类型、扩展名、链接**：提取每个附件的信息，用换行符分割显示
- **大小相关字段**：计算所有附件的总大小
- **适用场景**：支持单个或多个附件，自动适配处理方式

## 使用方法

### 1. 添加字段捷径

1. 在多维表格中点击添加字段
2. 选择"字段捷径"类型
3. 搜索并选择"附件元信息展示"插件

### 2. 配置参数

- **附件**：选择包含附件的字段

### 3. 查看结果

插件会自动分析选中附件字段中的所有文件，并以结构化的方式展示元信息：

- **单个附件**：直接展示该文件的所有信息
- **多个附件**：名称、类型、扩展名、链接分别列出，大小显示总和

## 应用场景

- 📊 **文件管理**：快速了解文件的基本信息
- 📈 **存储分析**：统计和分析文件大小分布
- 🔍 **文件筛选**：根据文件类型或大小进行筛选
- 📝 **文档整理**：批量获取文档的详细信息
- 💾 **存储优化**：识别大文件进行存储优化

## 技术特点

- ✅ **零依赖**：无需配置外部服务或API密钥
- ✅ **高性能**：本地处理，响应速度快
- ✅ **类型安全**：使用TypeScript开发，类型安全
- ✅ **错误处理**：完善的错误处理机制
- ✅ **多语言**：支持中英日三种语言

## 开发者信息

### 本地开发

```bash
# 安装依赖
npm install

# 启动开发服务器
npm run start

# 打包发布
npm run pack
```

### 技术架构

- 基于飞书多维表格字段捷径FaaS功能开发
- 使用TypeScript编写
- 支持完整的错误处理和日志记录
- 遵循飞书插件开发最佳实践

### 项目结构

```
├── src/
│   └── index.ts          # 主要逻辑文件
├── package.json          # 项目配置
├── tsconfig.json         # TypeScript配置
└── README.md            # 项目说明
```

## 版本信息

- **当前版本**：1.0.0
- **兼容性**：飞书多维表格字段捷径 API
- **更新时间**：2025-05-24

## 支持与反馈

如有问题或建议，请通过以下方式联系：

- 提交GitHub Issue
